<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bbs4m.forum.dao.ForumContentDao">
    <select id="getFirstContentByThemeId" parameterType="String" resultType="com.bbs4m.forum.entities.ForumContent">
        SELECT A.ID,
              A.VERSION,
              A.ORDER_NUMBER,
              A.THEME_REF_ID,
              A.CONTENT,
              A.PIC_FLAG,
              A.PIC_ID,
              A.LIKE_COUNT,
              A.DISLIKE_COUNT,
              A.CREATER,
              B.USER_NAME,
              A.CREATE_TIME,
              A.CUSTOM1,
              A.CUSTOM2,
              A.CUSTOM3,
              A.CUSTOM4,
              A.CUSTOM5
            FROM FORUM_CONTENT A LEFT JOIN LOGIN_DATA B ON A.CREATER = B.USERID WHERE A.THEME_REF_ID = #{themeId} ORDER BY A.ORDER_NUMBER LIMIT 0, 1
    </select>
    <select id="getReplyNumber" parameterType="String" resultType="String">
        SELECT CAST(COUNT(*) AS CHAR) FROM FORUM_CONTENT WHERE THEME_REF_ID = #{themeId}
    </select>
    <select id="getLastReply" parameterType="String" resultType="com.bbs4m.forum.entities.ForumContent">
        SELECT A.ID,
              A.VERSION,
              A.ORDER_NUMBER,
              A.THEME_REF_ID,
              A.CONTENT,
              A.PIC_FLAG,
              A.PIC_ID,
              A.LIKE_COUNT,
              A.DISLIKE_COUNT,
              A.CREATER,
              B.USER_NAME,
              A.CREATE_TIME,
              A.CUSTOM1,
              A.CUSTOM2,
              A.CUSTOM3,
              A.CUSTOM4,
              A.CUSTOM5
            FROM FORUM_CONTENT A LEFT JOIN LOGIN_DATA B ON A.CREATER = B.USERID WHERE A.THEME_REF_ID = #{themeId} ORDER BY A.ORDER_NUMBER DESC LIMIT 0, 1
    </select>
    <select id="getForumContentExcludeFirstContentByThemeid" parameterType="String"
            resultType="com.bbs4m.forum.entities.ForumContent">
        SELECT
              A.ID,
              A.VERSION,
              A.ORDER_NUMBER,
              A.THEME_REF_ID,
              A.CONTENT,
              A.PIC_FLAG,
              A.PIC_ID,
              A.LIKE_COUNT,
              A.DISLIKE_COUNT,
              A.CREATER,
              B.USER_NAME,
              A.CREATE_TIME,
              A.CUSTOM1,
              A.CUSTOM2,
              A.CUSTOM3,
              A.CUSTOM4,
              A.CUSTOM5
            FROM FORUM_CONTENT A LEFT JOIN LOGIN_DATA B ON A.CREATER = B.USERID
            WHERE A.THEME_REF_ID = #{themeId} AND A.ORDER_NUMBER != '1'
            ORDER BY A.ORDER_NUMBER;
    </select>
</mapper>